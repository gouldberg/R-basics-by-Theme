brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_08, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_08, lty = 1, col = "red", lwd = 2)
# ----------
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_08, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g2, lty = 1, col = "red", lwd = 2)
sum(g2_mean > mean_g1) / length(g2_mean)
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g1, lty = 1, col = "red", lwd = 2)
sum(g2_mean > mean_g1) / length(g2_mean)
sum(g2_mean > mean_g1) / length(g2_mean)
sum(g1_mean < mean_g2) / length(g1_mean)
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g2, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g1, lty = 1, col = "red", lwd = 2)
sum(g2_mean > mean_g1) / length(g2_mean)
sum(g1_mean < mean_g2) / length(g1_mean)
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.01)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g2, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g1, lty = 1, col = "red", lwd = 2)
sum(g2_mean > mean_g1) / length(g2_mean)
g1_mean <- sapply(1:100, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:100, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.01)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g2, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g1, lty = 1, col = "red", lwd = 2)
sum(g2_mean > mean_g1) / length(g2_mean)
sum(g1_mean < mean_g2) / length(g1_mean)
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.01)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g2, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = mean_g1, lty = 1, col = "red", lwd = 2)
sum(g2_mean > mean_g1) / length(g2_mean)
sum(g1_mean < mean_g2) / length(g1_mean)
g1_095 <- quantile(g1_mean, 0.95)
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
g1_095 <- quantile(g1_mean, 0.95)
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.01)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_095, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_095, lty = 1, col = "red", lwd = 2)
sum(g2_mean > g1_095) / length(g2_mean)
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
g1_0975 <- quantile(g1_mean, 0.975)
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.01)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_0975, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_0975, lty = 1, col = "red", lwd = 2)
sum(g2_mean > g1_0975) / length(g2_mean)
g1_thre <- quantile(g1_mean, 0.95)
g1_thre <- quantile(g1_mean, 0.95)
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.01)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
sum(g2_mean > g1_0975) / length(g2_mean)
sum(g2_mean > g1_thre) / length(g2_mean)
sum(g2_mean >= g1_thre) / length(g2_mean)
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
sum(g2_mean > g1_thre) / length(g2_mean)
g1_thre <- quantile(g1_mean, 0.975)
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
( g1_thre <- quantile(g1_mean, 0.975) )
sum(g2_mean > g1_thre) / length(g2_mean)
( g2_thre <- quantile(g2_mean, 0.025) )
( g1_thre <- quantile(g1_mean, 0.975) )
( g2_thre <- quantile(g2_mean, 0.025) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(2,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g2_thre, lty = 1, col = "red", lwd = 2)
sum(g2_mean > g1_thre) / length(g2_mean)
sum(g1_mean < g2_thre) / length(g1_mean)
diff <- g2_mean - g1_mean
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
diff <- g2_mean - g1_mean
( g1_thre <- quantile(g1_mean, 0.975) )
( g2_thre <- quantile(g2_mean, 0.025) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g1_thre, lty = 1, col = "red", lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
abline(v = g2_thre, lty = 1, col = "red", lwd = 2)
brk2 <- seq(min(diff) - 0.2, max(diff) + 0.2, by = 0.1)
hist(diff, breaks = brk2)
sum(diff > 0) / length(diff)
sum(diff > mean_g2 - mean_g1) / length(diff)
n1 <- 10
n2 <- 8
mean_g1 <- 5.0
mean_g2 <- 5.6
sd_common <- 1
myfunc <- function(n, mean, sd){
dat <- rnorm(n = n1, mean = mean, sd = sd)
return(mean(dat))
}
# ----------
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
diff <- g2_mean - g1_mean
( g1_thre <- quantile(g1_mean, 0.975) )
( g2_thre <- quantile(g2_mean, 0.025) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
brk2 <- seq(min(diff) - 0.2, max(diff) + 0.2, by = 0.1)
hist(diff, breaks = brk2)
# ----------
sum(diff > 0) / length(diff)
sum(diff > mean_g2 - mean_g1) / length(diff)
n1 <- 22
n2 <- 22
mean_g1 <- 5.0
mean_g2 <- 6.0
sd_common <- 1
myfunc <- function(n, mean, sd){
dat <- rnorm(n = n1, mean = mean, sd = sd)
return(mean(dat))
}
# ----------
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
diff <- g2_mean - g1_mean
( g1_thre <- quantile(g1_mean, 0.975) )
( g2_thre <- quantile(g2_mean, 0.025) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
brk2 <- seq(min(diff) - 0.2, max(diff) + 0.2, by = 0.1)
hist(diff, breaks = brk2)
( g1_thre <- quantile(g1_mean, 0.95) )
sum(diff > 1) / length(diff)
sum(diff > mean_g2 - mean_g1) / length(diff)
sum(mean_g2 > g1_thre) / length(mean_g2)
g1_thre
sum(mean_g2 > g1_thre) / length(mean_g2)
( g1_thre <- quantile(g1_mean, 0.975) )
sum(mean_g2 > g1_thre) / length(mean_g2)
mean_g2
sum(g2_mean > g1_thre) / length(mean_g2)
sum(g2_mean > g1_thre) / length(g2_mean)
( g1_thre <- quantile(g1_mean, 0.95) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
brk2 <- seq(min(diff) - 0.2, max(diff) + 0.2, by = 0.1)
hist(diff, breaks = brk2)
# ----------
sum(diff > 1) / length(diff)
sum(g2_mean > g1_thre) / length(g2_mean)
n1 <- 394
n2 <- 394
mean_g1 <- 5.0
sd_common <- 1
effect_size <- 0.2
mean_g2 <- mean_g1 + sd_cmmon * effect_size
myfunc <- function(n, mean, sd){
dat <- rnorm(n = n1, mean = mean, sd = sd)
return(mean(dat))
}
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
diff <- g2_mean - g1_mean
mean_g2 <- mean_g1 + sd_cmmon * effect_size
mean_g1 <- 5.0
sd_common <- 1
effect_size <- 0.2
mean_g2 <- mean_g1 + sd_cmmon * effect_size
mean_g2 <- mean_g1 + sd_common * effect_size
# ----------
myfunc <- function(n, mean, sd){
dat <- rnorm(n = n1, mean = mean, sd = sd)
return(mean(dat))
}
# ----------
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
diff <- g2_mean - g1_mean
( g1_thre <- quantile(g1_mean, 0.95) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.2, max_all + 0.2, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
n1 <- 394
n2 <- 394
mean_g1 <- 5.0
sd_common <- 0.1
effect_size <- 0.2
mean_g2 <- mean_g1 + sd_common * effect_size
# ----------
myfunc <- function(n, mean, sd){
dat <- rnorm(n = n1, mean = mean, sd = sd)
return(mean(dat))
}
# ----------
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
diff <- g2_mean - g1_mean
( g1_thre <- quantile(g1_mean, 0.95) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
n1 <- 394
n2 <- 394
mean_g1 <- 5.0
sd_common <- 1
effect_size <- 0.2
mean_g2 <- mean_g1 + sd_common * effect_size
# ----------
myfunc <- function(n, mean, sd){
dat <- rnorm(n = n1, mean = mean, sd = sd)
return(mean(dat))
}
# ----------
g1_mean <- sapply(1:10000, function(x) { myfunc(n = n1, mean = mean_g1, sd = sd_common) } )
g2_mean <- sapply(1:10000, function(x) { myfunc(n = n2, mean = mean_g2, sd = sd_common) } )
diff <- g2_mean - g1_mean
( g1_thre <- quantile(g1_mean, 0.95) )
# ----------
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
( g1_thre <- quantile(g1_mean, 0.95) )
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
brk2 <- seq(min(diff) - 0.2, max(diff) + 0.2, by = 0.1)
hist(diff, breaks = brk2)
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
brk2 <- seq(min(diff) - 0.1, max(diff) + 0.1, by = 0.01)
hist(diff, breaks = brk2)
g1_mean <- rnorm(n = n1, mean = mean_g1, sd = sd_common)
g2_mean <- rnorm(n = n2, mean = mean_g2, sd = sd_common)
diff <- g2_mean - g1_mean
( g1_thre <- quantile(g1_mean, 0.95) )
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
# ----------
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
min_all <- min(c(g1_mean, g2_mean))
max_all <- max(c(g1_mean, g2_mean))
min_all
max_all
( g1_thre <- quantile(g1_mean, 0.95) )
mean(g1_mean)
mean(g2_mean)
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
par(mfrow = c(2,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.011)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
par(mfrow = c(2,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.1)
hist(g1_mean, breaks = brk)
abline(v = c(mean(g1_mean), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(g2_mean, breaks = brk)
abline(v = c(mean(g2_mean), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
( g1_thre <- quantile(g1_mean, 0.95) )
sum(g2_mean < g1_thre) / length(g2_mean)
n1 <- 394
n2 <- 394
mean_g1 <- 5.0
sd_common <- 1
effect_size <- 0.2
mean_g2 <- mean_g1 + sd_common * effect_size
# ----------
myfunc <- function(n1, n2, mean_g1, mean_g2, sd_common, alpha){
dat1 <- rnorm(n = n1, mean = mean_g1, sd = sd_common)
dat2 <- rnorm(n = n2, mean = mean_g2, sd = sd_common)
g1_thre <- quantile(g1_mean, 1 - alpha)
obj <- sum(dat2 > g1_thre) / length(dat2)
return(obj)
}
# ----------
alpha <- 0.05
beta <- sapply(1:10000, function(x) { myfunc(n1, n2, mean_g1, mean_g2, sd_common, alpha) } )
hist(beta)
summary(beta)
n1 <- 394
n2 <- 394
mean_g1 <- 5.0
sd_common <- 1
effect_size <- 0.2
mean_g2 <- mean_g1 + sd_common * effect_size
# ----------
alpha <- 0.05
dat1 <- rnorm(n = n1, mean = mean_g1, sd = sd_common)
dat2 <- rnorm(n = n2, mean = mean_g2, sd = sd_common)
g1_thre <- quantile(g1_mean, 1 - alpha)
beta_obj <- sum(dat2 > g1_thre) / length(dat2)
# ----------
min_all <- min(c(dat1, dat2))
max_all <- max(c(dat1, dat2))
par(mfrow = c(3,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.1)
hist(dat1, breaks = brk)
abline(v = c(mean(dat1), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(dat2, breaks = brk)
abline(v = c(mean(dat2), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
print(beta_obj)
min_all <- min(c(dat1, dat2))
max_all <- max(c(dat1, dat2))
par(mfrow = c(2,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.1)
hist(dat1, breaks = brk)
abline(v = c(mean(dat1), mean_g1), lty = c(1,2), col = c("black","blue"), lwd = 2)
hist(dat2, breaks = brk)
abline(v = c(mean(dat2), mean_g2), lty = c(1,2), col = c("black","blue"), lwd = 2)
print(beta_obj)
min_all <- min(c(dat1, dat2))
max_all <- max(c(dat1, dat2))
par(mfrow = c(2,1))
brk <- seq(min_all - 0.1, max_all + 0.1, by = 0.1)
hist(dat1, breaks = brk)
abline(v = c(mean(dat1), mean_g1, g1_thre), lty = c(1, 2, 2), col = c("black", "blue", "red"), lwd = 2)
hist(dat2, breaks = brk)
abline(v = c(mean(dat2), mean_g2, g1_thre), lty = c(1, 2, 2), col = c("black", "blue", "red"), lwd = 2)
print(beta_obj)
myfunc <- function(n1, n2, mean_g1, mean_g2, sd_common, alpha){
dat1 <- rnorm(n = n1, mean = mean_g1, sd = sd_common)
dat2 <- rnorm(n = n2, mean = mean_g2, sd = sd_common)
g1_thre <- quantile(g1_mean, 1 - alpha)
obj <- sum(dat2 > g1_thre) / length(dat2)
return(obj)
}
beta <- sapply(1:10000, function(x) { myfunc(n1, n2, mean_g1, mean_g2, sd_common, alpha) } )
summary(beta)
